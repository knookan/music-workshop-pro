{"version":3,"file":"parent-dummy-chains.js","sources":["../../../../node_modules/dagre/lib/parent-dummy-chains.js"],"sourcesContent":["var _ = require(\"./lodash\");\n\nmodule.exports = parentDummyChains;\n\nfunction parentDummyChains(g) {\n  var postorderNums = postorder(g);\n\n  _.forEach(g.graph().dummyChains, function(v) {\n    var node = g.node(v);\n    var edgeObj = node.edgeObj;\n    var pathData = findPath(g, postorderNums, edgeObj.v, edgeObj.w);\n    var path = pathData.path;\n    var lca = pathData.lca;\n    var pathIdx = 0;\n    var pathV = path[pathIdx];\n    var ascending = true;\n\n    while (v !== edgeObj.w) {\n      node = g.node(v);\n\n      if (ascending) {\n        while ((pathV = path[pathIdx]) !== lca &&\n               g.node(pathV).maxRank < node.rank) {\n          pathIdx++;\n        }\n\n        if (pathV === lca) {\n          ascending = false;\n        }\n      }\n\n      if (!ascending) {\n        while (pathIdx < path.length - 1 &&\n               g.node(pathV = path[pathIdx + 1]).minRank <= node.rank) {\n          pathIdx++;\n        }\n        pathV = path[pathIdx];\n      }\n\n      g.setParent(v, pathV);\n      v = g.successors(v)[0];\n    }\n  });\n}\n\n// Find a path from v to w through the lowest common ancestor (LCA). Return the\n// full path and the LCA.\nfunction findPath(g, postorderNums, v, w) {\n  var vPath = [];\n  var wPath = [];\n  var low = Math.min(postorderNums[v].low, postorderNums[w].low);\n  var lim = Math.max(postorderNums[v].lim, postorderNums[w].lim);\n  var parent;\n  var lca;\n\n  // Traverse up from v to find the LCA\n  parent = v;\n  do {\n    parent = g.parent(parent);\n    vPath.push(parent);\n  } while (parent &&\n           (postorderNums[parent].low > low || lim > postorderNums[parent].lim));\n  lca = parent;\n\n  // Traverse from w to LCA\n  parent = w;\n  while ((parent = g.parent(parent)) !== lca) {\n    wPath.push(parent);\n  }\n\n  return { path: vPath.concat(wPath.reverse()), lca: lca };\n}\n\nfunction postorder(g) {\n  var result = {};\n  var lim = 0;\n\n  function dfs(v) {\n    var low = lim;\n    _.forEach(g.children(v), dfs);\n    result[v] = { low: low, lim: lim++ };\n  }\n  _.forEach(g.children(), dfs);\n\n  return result;\n}\n"],"names":["require$$0"],"mappings":";;;;;;;;CAAA,IAAI,CAAC,GAAGA,aAAA,EAAmB;;AAE3B,CAAA,mBAAc,GAAG,iBAAiB;;CAElC,SAAS,iBAAiB,CAAC,CAAC,EAAE;AAC9B,GAAE,IAAI,aAAa,GAAG,SAAS,CAAC,CAAC,CAAC;;AAElC,GAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,WAAW,EAAE,SAAS,CAAC,EAAE;KAC3C,IAAI,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;AACxB,KAAI,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO;AAC9B,KAAI,IAAI,QAAQ,GAAG,QAAQ,CAAC,CAAC,EAAE,aAAa,EAAE,OAAO,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC;AACnE,KAAI,IAAI,IAAI,GAAG,QAAQ,CAAC,IAAI;AAC5B,KAAI,IAAI,GAAG,GAAG,QAAQ,CAAC,GAAG;KACtB,IAAI,OAAO,GAAG,CAAC;AACnB,KAAI,IAAI,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC;KACzB,IAAI,SAAS,GAAG,IAAI;;AAExB,KAAI,OAAO,CAAC,KAAK,OAAO,CAAC,CAAC,EAAE;AAC5B,OAAM,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;;OAEhB,IAAI,SAAS,EAAE;SACb,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG;AAC9C,gBAAe,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,EAAE;AAClD,WAAU,OAAO,EAAE;AACnB,SAAA;;AAEA,SAAQ,IAAI,KAAK,KAAK,GAAG,EAAE;WACjB,SAAS,GAAG,KAAK;AAC3B,SAAA;AACA,OAAA;;OAEM,IAAI,CAAC,SAAS,EAAE;AACtB,SAAQ,OAAO,OAAO,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC;AACxC,gBAAe,CAAC,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,IAAI,IAAI,CAAC,IAAI,EAAE;AACvE,WAAU,OAAO,EAAE;AACnB,SAAA;AACA,SAAQ,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC;AAC7B,OAAA;;AAEA,OAAM,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,KAAK,CAAC;OACrB,CAAC,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAC5B,KAAA;AACA,GAAA,CAAG,CAAC;AACJ,CAAA;;AAEA;AACA;CACA,SAAS,QAAQ,CAAC,CAAC,EAAE,aAAa,EAAE,CAAC,EAAE,CAAC,EAAE;GACxC,IAAI,KAAK,GAAG,EAAE;GACd,IAAI,KAAK,GAAG,EAAE;GACd,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,aAAa,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;GAC9D,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,aAAa,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;AAChE,GAAE,IAAI,MAAM;AACZ,GAAE,IAAI,GAAG;;AAET;GACE,MAAM,GAAG,CAAC;AACZ,GAAE,GAAG;AACL,KAAI,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC;AAC7B,KAAI,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC;AACtB,GAAA,CAAG,QAAQ,MAAM;AACjB,aAAY,aAAa,CAAC,MAAM,CAAC,CAAC,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,aAAa,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC;GAC7E,GAAG,GAAG,MAAM;;AAEd;GACE,MAAM,GAAG,CAAC;AACZ,GAAE,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,EAAE;AAC9C,KAAI,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC;AACtB,GAAA;;AAEA,GAAE,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE;AAC1D,CAAA;;CAEA,SAAS,SAAS,CAAC,CAAC,EAAE;GACpB,IAAI,MAAM,GAAG,EAAE;GACf,IAAI,GAAG,GAAG,CAAC;;AAEb,GAAE,SAAS,GAAG,CAAC,CAAC,EAAE;KACd,IAAI,GAAG,GAAG,GAAG;AACjB,KAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC;AACjC,KAAI,MAAM,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;AACxC,GAAA;GACE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC;;AAE9B,GAAE,OAAO,MAAM;AACf,CAAA;;;;;;","x_google_ignoreList":[0]}